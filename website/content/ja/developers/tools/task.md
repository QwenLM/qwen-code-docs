# タスクツール (`task`)

このドキュメントでは、Qwen Code 用の `task` ツールについて説明します。

## 説明

複雑で複数ステップにわたるタスクを自律的に処理するために、専用のサブエージェントを起動するには `task` を使用します。タスクツールは、独自のツールセットにアクセスして独立して動作できる専門エージェントに作業を委任することで、並列タスク実行と専門知識の活用を可能にします。

### 引数

`task` は以下の引数を取ります：

- `description` (文字列, 必須): ユーザーの視認性および追跡目的のための、タスクの短い（3〜5語）説明。
- `prompt` (文字列, 必須): サブエージェントが実行する詳細なタスクプロンプト。自律的な実行のための包括的な指示を含める必要があります。
- `subagent_type` (文字列, 必須): このタスクに使用する専門エージェントのタイプ。利用可能な設定済みサブエージェントのいずれかと一致する必要があります。

## Qwen Code で `task` を使用する方法

Task ツールは、設定から利用可能なサブエージェントを動的に読み込み、それらにタスクを委任します。各サブエージェントは独立して実行され、独自のツールセットを使用できるため、専門的な知識と並列実行が可能になります。

Task ツールを使用すると、サブエージェントは以下の処理を行います：

1. 完全な自律性を持ってタスクプロンプトを受け取る
2. 利用可能なツールを使用してタスクを実行する
3. 最終結果メッセージを返す
4. 終了する（サブエージェントはステートレスで一度きりの使用）

使用方法：

```
task(description="タスクの簡単な説明", prompt="サブエージェント向けの詳細なタスク指示", subagent_type="エージェント名")
```

## 利用可能なサブエージェント

利用可能なサブエージェントは設定によって異なります。一般的なサブエージェントの種類には以下が含まれる場合があります：

- **general-purpose**：様々なツールを必要とする複雑なマルチステップタスク用
- **code-reviewer**：コード品質のレビューと分析用
- **test-runner**：テストの実行と結果分析用
- **documentation-writer**：ドキュメントの作成と更新用

Qwen Codeで`/agents`コマンドを使用することで、利用可能なサブエージェントを確認できます。

## タスクツールの機能

### リアルタイム進捗アップデート

タスクツールは以下の情報を表示するライブアップデートを提供します：

- サブエージェントの実行状況
- サブエージェントが実行している個々のツール呼び出し
- ツール呼び出しの結果とエラー情報
- 全体的なタスクの進捗と完了状況

### 並列実行

1つのメッセージ内でタスクツールを複数回呼び出すことで、複数のサブエージェントを同時に起動でき、並列タスク実行と効率性の向上が可能になります。

### 専門的スキル

各サブエージェントは以下のように設定できます：

- 特定のツールアクセス権限
- 専門的なシステムプロンプトおよび指示
- カスタムモデル設定
- ドメイン固有の知識と能力

## `task` の例

### 汎用エージェントへの委譲

```
task(
  description="コードのリファクタリング",
  prompt="src/auth/ 内の認証モジュールを、コールバックではなく現代的な async/await パターンを使用するようにリファクタリングしてください。すべてのテストが引き続き通ることを確認し、関連ドキュメントがあれば更新してください。",
  subagent_type="general-purpose"
)
```

### 並列タスクの実行

```

# コードレビューとテスト実行を並列に起動
task(
  description="コードレビュー",
  prompt="ユーザ管理モジュールの最近の変更について、コード品質、セキュリティ問題、ベストプラクティス遵守の観点からレビューしてください。",
  subagent_type="code-reviewer"
)

task(
  description="テスト実行",
  prompt="フルテストスイートを実行し、失敗があれば分析してください。テストカバレッジの概要と改善提案を提供してください。",
  subagent_type="test-runner"
)
```

### ドキュメント生成

```
task(
  description="ドキュメント更新",
  prompt="注文モジュールに新しく実装されたRESTエンドポイントの包括的なAPIドキュメントを生成してください。リクエスト/レスポンス例とエラーコードを含めてください。",
  subagent_type="documentation-writer"
)
```

## タスクツールを使用するタイミング

タスクツールは以下のケースで使用してください：

1. **複雑なマルチステップタスク** - 自主的に処理できる複数の操作を必要とするタスク
2. **専門的知識が必要なタスク** - ドメイン固有の知識やツールが役立つタスク
3. **並列実行** - 同時に実行可能な複数の独立したタスクがある場合
4. **委譲が必要な場合** - ステップごとの細かな管理ではなく、完全なタスクを任せたいとき
5. **リソース集約型操作** - 多大な時間や計算リソースを必要とするタスク

## タスクツールを使用しないタイミング

タスクツールは以下の場合には使用しないでください：

- **シンプルな単一ステップ操作** - Read、Editなどの直接的なツールを使用してください
- **インタラクティブなタスク** - 双方向の通信を必要とするタスク
- **特定ファイルの読み込み** - パフォーマンス向上のためReadツールを直接使用してください
- **シンプルな検索** - GrepまたはGlobツールを直接使用してください

## 重要な注意点

- **ステートレス実行**: 各サブエージェントの呼び出しは独立しており、以前の実行内容を記憶しません
- **単一通信**: サブエージェントは最終結果メッセージのみを提供し、継続的な通信はありません
- **包括的なプロンプト**: プロンプトには自律的に実行するために必要なすべてのコンテキストと指示を含める必要があります
- **ツールアクセス**: サブエージェントは特定の設定で構成されたツールにのみアクセスできます
- **並列処理能力**: 効率向上のため、複数のサブエージェントを同時に実行できます
- **設定依存**: 利用可能なサブエージェントの種類はシステム設定に依存します

## 設定

サブエージェントは、Qwen Code のエージェント設定システムを通じて設定されます。`/agents` コマンドを使用して以下の操作を行えます：

- 利用可能なサブエージェントの確認
- 新しいサブエージェント設定の作成
- 既存のサブエージェント設定の変更
- ツールの権限と機能の設定

サブエージェントの設定に関する詳細情報については、サブエージェントのドキュメントを参照してください。