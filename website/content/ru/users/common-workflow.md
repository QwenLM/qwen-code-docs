# Распространенные рабочие процессы

> Узнайте о распространенных рабочих процессах с Qwen Code.

Каждая задача в этом документе включает четкие инструкции, примеры команд и лучшие практики, которые помогут вам максимально эффективно использовать Qwen Code.

## Понимание новых кодовых баз

### Быстрый обзор кодовой базы

Предположим, вы только что присоединились к новому проекту и вам нужно быстро понять его структуру.

**1. Перейдите в корневую директорию проекта**

```bash
cd /path/to/project
```

**2. Запустите Qwen Code**

```bash
qwen
```

**3. Запросите высокоуровневый обзор**

```
дай мне обзор этой кодовой базы
```

**4. Углубитесь в конкретные компоненты**

```
объясни основные архитектурные паттерны, используемые здесь
```

```
какие ключевые модели данных используются?
```

```
как реализована аутентификация?
```

> [!tip]
>
> - Начинайте с общих вопросов, затем переходите к конкретным областям
> - Спрашивайте о соглашениях по кодированию и паттернах, используемых в проекте
> - Запрашивайте глоссарий терминов, специфичных для проекта

### Поиск релевантного кода

Предположим, вам нужно найти код, связанный с определённой функцией или функциональностью.

**1. Попросите Qwen Code найти соответствующие файлы**

```
найти файлы, которые обрабатывают аутентификацию пользователей
```

**2. Получите контекст о том, как компоненты взаимодействуют**

```
как эти файлы аутентификации работают вместе?
```

**3. Разберитесь в потоке выполнения**

```
проследить процесс входа от фронтенда до базы данных
```

> [!tip]
>
> - Будьте конкретны в том, что вы ищете
> - Используйте терминологию предметной области проекта

## Эффективное исправление ошибок

Предположим, вы столкнулись с сообщением об ошибке и вам нужно найти и устранить её источник.

**1. Поделитесь ошибкой с Qwen Code**

```
Я вижу ошибку при запуске npm test
```

**2. Попросите рекомендации по исправлению**

```
предложи несколько способов исправить @ts-ignore в user.ts
```

**3. Примените исправление**

```
обнови user.ts, чтобы добавить проверку на null, которую ты предложил
```

> [!tip]
>
> - Сообщите Qwen Code команду для воспроизведения проблемы и получения трассировки стека
> - Укажите любые шаги для воспроизведения ошибки
> - Сообщите Qwen Code, является ли ошибка периодической или постоянной

## Рефакторинг кода

Предположим, вам нужно обновить старый код, чтобы использовать современные шаблоны и практики.

**1. Определите устаревший код для рефакторинга**

```
найти использование устаревшего API в нашей кодовой базе
```

**2. Получите рекомендации по рефакторингу**

```
предложить, как рефакторить utils.js для использования современных возможностей JavaScript
```

**3. Безопасно примените изменения**

```
рефакторить utils.js для использования возможностей ES 2024, сохранив прежнее поведение
```

**4. Проверьте рефакторинг**

```
запустить тесты для рефакторингового кода
```

> [!tip]
>
> - Попросите Qwen Code объяснить преимущества современного подхода
> - Запрашивайте сохранение обратной совместимости при необходимости
> - Выполняйте рефакторинг небольшими, тестируемыми частями

## Использование специализированных подагентов

Предположим, вы хотите использовать специализированные AI-подагенты для более эффективного выполнения определенных задач.

**1. Просмотр доступных подагентов**

```
/agents
```

Это отобразит всех доступных подагентов и позволит создать новых.

**2. Автоматическое использование подагентов**

Qwen Code автоматически делегирует соответствующие задачи специализированным подагентам:

```
проверь мои последние изменения кода на наличие проблем безопасности
```

```
запусти все тесты и исправь ошибки
```

**3. Явный запрос конкретных подагентов**

```
используй подагент code-reviewer для проверки модуля аутентификации
```

```
поручи подагенту debugger выяснить, почему пользователи не могут войти в систему
```

**4. Создание собственных подагентов для вашего рабочего процесса**

```
/agents
```

Затем выберите «создать» и следуйте инструкциям, чтобы определить:

- Уникальный идентификатор, описывающий назначение подагента (например, `code-reviewer`, `api-designer`).
- Когда Qwen Code должен использовать этого агента
- Какие инструменты ему доступны
- Системную подсказку, описывающую роль и поведение агента

> [!tip]
>
> - Создавайте проектные подагенты в `.qwen/agents/` для совместного использования в команде
> - Используйте содержательные поля `description`, чтобы включить автоматическую делегацию
> - Ограничьте доступ к инструментам только теми, которые действительно необходимы каждому подагенту
> - Подробнее о [Подагентах](./features/sub-agents)
> - Подробнее о [Режиме одобрения](./features/approval-mode)

## Работа с тестами

Предположим, вам нужно добавить тесты для кода, который не покрыт тестами.

**1. Определите непроверенный код**

```
найти функции в NotificationsService.swift, которые не покрыты тестами
```

**2. Сгенерируйте каркас тестов**

```
добавить тесты для сервиса уведомлений
```

**3. Добавьте содержательные тестовые случаи**

```
добавить тестовые случаи для граничных условий в сервисе уведомлений
```

**4. Запустите и проверьте тесты**

```
запустить новые тесты и исправить все ошибки
```

Qwen Code может генерировать тесты, которые следуют существующим шаблонам и соглашениям вашего проекта. При запросе тестов конкретизируйте, какое поведение вы хотите проверить. Qwen Code изучает ваши существующие тестовые файлы, чтобы соответствовать стилю, фреймворкам и шаблонам утверждений, уже используемым в проекте.

Для полного охвата попросите Qwen Code определить граничные случаи, которые вы могли упустить. Qwen Code может проанализировать пути выполнения кода и предложить тесты для условий ошибок, пограничных значений и неожиданных входных данных, которые легко упустить.

## Создание pull request'ов

Предположим, вам нужно создать хорошо документированный pull request для ваших изменений.

**1. Обобщите свои изменения**

```
обобщить изменения, которые я внес в модуль аутентификации
```

**2. Создайте pull request с помощью Qwen Code**

```
создать pr
```

**3. Проверьте и доработайте**

```
улучшить описание PR, добавив больше контекста о совершенных улучшениях безопасности
```

**4. Добавьте информацию о тестировании**

```
добавить информацию о том, как эти изменения были протестированы
```

> [!tip]
>
> - Попросите Qwen Code напрямую создать PR за вас
> - Проверьте сгенерированный Qwen Code PR перед отправкой
> - Попросите Qwen Code выделить потенциальные риски или моменты, на которые стоит обратить внимание

## Работа с документацией

Предположим, вам нужно добавить или обновить документацию для вашего кода.

**1. Найдите недокументированный код**

```
найти функции без надлежащих комментариев JSDoc в модуле аутентификации
```

**2. Создайте документацию**

```
добавить комментарии JSDoc к недокументированным функциям в auth.js
```

**3. Проверьте и улучшите**

```
улучшить созданную документацию, добавив больше контекста и примеров
```

**4. Подтвердите документацию**

```
проверить, соответствует ли документация стандартам нашего проекта
```

> [!tip]
>
> - Укажите желаемый стиль документации (JSDoc, docstrings и т. д.)
> - Попросите добавить примеры в документацию
> - Запрашивайте документацию для публичных API, интерфейсов и сложной логики

## Ссылки на файлы и каталоги

Используйте `@`, чтобы быстро включить файлы или каталоги без ожидания чтения их Qwen Code.

**1. Ссылка на один файл**

```
Объясни логику в @src/utils/auth.js
```

Это включает полное содержимое файла в разговор.

**2. Ссылка на каталог**

```
Какова структура @src/components?
```

Это предоставляет список каталогов с информацией о файлах.

**3. Ссылка на ресурсы MCP**

```
Покажи мне данные из @github: repos/owner/repo/issues
```

Это извлекает данные из подключенных серверов MCP, используя формат @сервер: ресурс. Подробнее см. [MCP](./features/mcp).

> [!tip]
>
> - Пути к файлам могут быть относительными или абсолютными
> - Ссылки на файлы через @ добавляют `QWEN.md` в каталоге файла и родительских каталогах в контекст
> - Ссылки на каталоги показывают списки файлов, а не их содержимое
> - Вы можете ссылаться на несколько файлов в одном сообщении (например, "`@файл1.js` и `@файл2.js`")

## Возобновление предыдущих разговоров

Предположим, вы работали над задачей с Qwen Code и хотите продолжить с того места, где остановились, в более поздней сессии.

Qwen Code предоставляет две опции для возобновления предыдущих разговоров:

- `--continue` — автоматически продолжить самый последний разговор
- `--resume` — отобразить выбор разговора

**1. Продолжение самого последнего разговора**

```bash
qwen --continue
```

Это немедленно возобновляет ваш самый последний разговор без каких-либо запросов.

**2. Продолжение в неинтерактивном режиме**

```bash
qwen --continue --p "Continue with my task"
```

Используйте `--print` вместе с `--continue`, чтобы возобновить самый последний разговор в неинтерактивном режиме — идеально подходит для скриптов или автоматизации.

**3. Отображение выбора разговора**

```bash
qwen --resume
```

Открывается интерактивный выбор разговора с чистым списком, в котором отображается:

- Сводка сессии (или начальный запрос)
- Метаданные: прошедшее время, количество сообщений и git-ветка

Используйте стрелки для навигации и нажмите Enter, чтобы выбрать разговор. Нажмите Esc для выхода.

> [!tip]
>
> - История разговоров хранится локально на вашем компьютере
> - Используйте `--continue` для быстрого доступа к самому последнему разговору
> - Используйте `--resume`, когда нужно выбрать конкретный прошлый разговор
> - При возобновлении вы увидите всю историю разговора перед продолжением
> - Возобновляемый разговор начинается с той же модели и конфигурацией, что и оригинал
>
> **Как это работает**:
>
> 1. **Хранение разговоров**: Все разговоры автоматически сохраняются локально с полной историей сообщений
> 2. **Десериализация сообщений**: При возобновлении восстанавливается вся история сообщений для сохранения контекста
> 3. **Состояние инструментов**: Использование инструментов и результаты из предыдущего разговора сохраняются
> 4. **Восстановление контекста**: Разговор возобновляется со всем предыдущим контекстом
>
> **Примеры**:
>
> ```bash
> # Продолжить самый последний разговор
> qwen --continue
>
> # Продолжить самый последний разговор с конкретным запросом
> qwen --continue --p "Show me our progress"
>
> # Показать выбор разговора
> qwen --resume
>
> # Продолжить самый последний разговор в неинтерактивном режиме
> qwen --continue --p "Run the tests again"
> ```

## Запуск параллельных сессий Qwen Code с рабочими деревьями Git

Предположим, вам нужно одновременно работать над несколькими задачами с полной изоляцией кода между экземплярами Qwen Code.

**1. Понимание рабочих деревьев Git**

Рабочие деревья Git позволяют извлекать несколько веток из одного и того же репозитория в отдельные каталоги. Каждое рабочее дерево имеет свою собственную рабочую директорию с изолированными файлами, при этом используя одну и ту же историю Git. Узнайте больше в [официальной документации по git worktree](https://git-scm.com/docs/git-worktree).

**2. Создание нового рабочего дерева**

```bash

# Создание нового рабочего дерева с новой веткой
git worktree add ../project-feature-a -b feature-a

# Или создание рабочего дерева с существующей веткой
git worktree add ../project-bugfix bugfix-123
```

Это создает новый каталог с отдельной рабочей копией вашего репозитория.

**3. Запуск Qwen Code в каждом рабочем дереве**

```bash

# Переход в ваше рабочее дерево
cd ../project-feature-a

# Запуск кода Qwen в этом изолированном окружении
qwen
```

**4. Запуск кода Qwen в другом рабочем дереве**

```bash
cd ../project-bugfix
qwen
```

**5. Управление вашими рабочими деревьями**

```bash

# Список всех рабочих деревьев
git worktree list

# Удаление рабочего дерева после завершения работы
git worktree remove ../project-feature-a
```

> [!tip]
>
> - Каждое рабочее дерево имеет независимое состояние файлов, что делает его идеальным для параллельных сессий Qwen Code
> - Изменения, внесенные в одном рабочем дереве, не влияют на другие, предотвращая взаимное влияние экземпляров Qwen Code
> - Все рабочие деревья используют одну и ту же историю Git и удаленные подключения
> - Для длительных задач вы можете запустить Qwen Code в одном рабочем дереве, продолжая разработку в другом
> - Используйте понятные имена каталогов, чтобы легко определить, для какой задачи предназначено каждое рабочее дерево
> - Не забудьте инициализировать среду разработки в каждом новом рабочем дереве в соответствии с настройками вашего проекта. В зависимости от стека это может включать:
>   - Проекты JavaScript: Запуск установки зависимостей (`npm install`, `yarn`)
>   - Проекты Python: Настройка виртуальных сред или установка с помощью менеджеров пакетов
>   - Другие языки: Следование стандартному процессу настройки проекта

## Использование Qwen Code в качестве утилиты в стиле Unix

### Добавление Qwen Code в процесс проверки

Предположим, вы хотите использовать Qwen Code в качестве линтера или ревьюера кода.

**Добавьте Qwen Code в свой скрипт сборки:**

```json
// package.json
{
    ...
    "scripts": {
        ...
        "lint:Qwen Code": "qwen -p 'you are a linter. please look at the changes vs. main and report any issues related to typos. report the filename and line number on one line, and a description of the issue on the second line. do not return any other text.'"
    }
}
```

> [!tip]
>
> - Используйте Qwen Code для автоматического ревью кода в вашем CI/CD пайплайне
> - Настройте промт под конкретные проблемы, актуальные для вашего проекта
> - Рассмотрите возможность создания нескольких скриптов для разных типов проверок

### Ввод через pipe, вывод через pipe

Предположим, вы хотите передать данные в Qwen Code через pipe и получить структурированный вывод.

**Передача данных через Qwen Code с использованием pipe:**

```bash
cat build-error.txt | qwen -p 'concisely explain the root cause of this build error' > output.txt
```

> [!tip]
>
> - Используйте pipes для интеграции Qwen-Code в существующие shell-скрипты
> - Комбинируйте с другими Unix-утилитами для создания мощных рабочих процессов
> - Рассмотрите возможность использования --output-format для получения структурированного вывода

### Управление форматом вывода

Предположим, что вам нужен вывод Qwen Code в определённом формате, особенно при интеграции Qwen Code в скрипты или другие инструменты.

**1. Использование текстового формата (по умолчанию)**

```bash
cat data.txt | qwen -p 'summarize this data' --output-format text > summary.txt
```

Выводит только обычный текстовый ответ от Qwen Code (поведение по умолчанию).

**2. Использование JSON-формата**

```bash
cat code.py | qwen -p 'analyze this code for bugs' --output-format json > analysis.json
```

Выводит массив сообщений в формате JSON с метаданными, включая стоимость и продолжительность.

**3. Использование потокового JSON-формата**

```bash
cat log.txt | qwen -p 'parse this log file for errors' --output-format stream-json
```

Выводит серию JSON-объектов в реальном времени по мере обработки запроса Qwen Code. Каждое сообщение является допустимым JSON-объектом, но весь вывод в целом не будет допустимым JSON при объединении.

> [!tip]
>
> - Используйте `--output-format text` для простых интеграций, когда вам нужен только ответ от Qwen Code
> - Используйте `--output-format json`, если вам требуется полный журнал разговора
> - Используйте `--output-format stream-json` для получения вывода в реальном времени на каждом этапе разговора

## Задайте вопросы Qwen Code о его возможностях

Qwen Code имеет встроенный доступ к своей документации и может отвечать на вопросы о собственных функциях и ограничениях.

### Примеры вопросов

```
может ли Qwen Code создавать пулл-реквесты?
```

```
как Qwen Code обрабатывает разрешения?
```

```
какие слэш-команды доступны?
```

```
как использовать MCP с Qwen Code?
```

```
как настроить Qwen Code для Amazon Bedrock?
```

```
в чём заключаются ограничения Qwen Code?
```

> [!note]
>
> Qwen Code предоставляет ответы на эти вопросы на основе документации. Для исполняемых примеров и практических демонстраций обратитесь к конкретным разделам рабочих процессов выше.

> [!tip]
>
> - Qwen Code всегда имеет доступ к последней документации Qwen Code, независимо от используемой вами версии
> - Задавайте конкретные вопросы, чтобы получить подробные ответы
> - Qwen Code может объяснить сложные функции, такие как интеграция MCP, корпоративные конфигурации и расширенные рабочие процессы