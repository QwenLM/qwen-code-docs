# Github Actions: qwen-code-action

## Обзор

`qwen-code-action` — это действие GitHub, которое интегрирует [Qwen Code] в ваш рабочий процесс разработки через [Qwen Code CLI]. Оно действует как автономный агент для критически важных рутинных задач кодирования, так и помощник по запросу, которому вы можете быстро делегировать работу.

Используйте его для выполнения проверок пулл-реквестов на GitHub, классификации проблем, анализа и модификации кода и многого другого с помощью [Qwen Code] в диалоговом режиме (например, `@qwencoder fix this issue`) прямо внутри ваших репозиториев GitHub.

- [qwen-code-action](#qwen-code-action)
  - [Обзор](#обзор)
  - [Возможности](#возможности)
  - [Быстрый старт](#быстрый-старт)
    - [1. Получите ключ API Qwen](#1-получите-ключ-api-qwen)
    - [2. Добавьте его как секрет GitHub](#2-добавьте-его-как-секрет-github)
    - [3. Обновите ваш .gitignore](#3-обновите-ваш-gitignore)
    - [4. Выберите рабочий процесс](#4-выберите-рабочий-процесс)
    - [5. Попробуйте его](#5-попробуйте-его)
  - [Рабочие процессы](#рабочие-процессы)
    - [Диспетчер Qwen Code](#диспетчер-qwen-code)
    - [Классификация задач](#классификация-задач)
    - [Проверка пулл-реквестов](#проверка-пулл-реквестов)
    - [Помощник CLI Qwen Code](#помощник-cli-qwen-code)
  - [Конфигурация](#конфигурация)
    - [Входные параметры](#входные-параметры)
    - [Выходные данные](#выходные-данные)
    - [Переменные репозитория](#переменные-репозитория)
    - [Секреты](#секреты)
  - [Аутентификация](#аутентификация)
    - [Аутентификация GitHub](#аутентификация-github)
  - [Расширения](#расширения)
  - [Лучшие практики](#лучшие-практики)
  - [Настройка](#настройка)
  - [Участие в проекте](#участие-в-проекте)

## Возможности

- **Автоматизация**: Запуск рабочих процессов на основе событий (например, открытие задачи) или по расписанию (например, еженощно).
- **Сотрудничество по запросу**: Запуск рабочих процессов в комментариях к задачам и пул-реквестам с помощью упоминания [Qwen Code CLI] (например, `@qwencoder /review`).
- **Расширяемость с помощью инструментов**: Использование возможностей вызова инструментов моделей [Qwen Code] для взаимодействия с другими CLI, такими как [GitHub CLI] (`gh`).
- **Настраиваемость**: Использование файла `QWEN.md` в вашем репозитории для предоставления специфичных для проекта инструкций и контекста [Qwen Code CLI].

## Быстрый старт

Начните работу с Qwen Code CLI в вашем репозитории всего за несколько минут:

### 1. Получите ключ API Qwen

Получите ваш ключ API из [DashScope] (платформа искусственного интеллекта Alibaba Cloud)

### 2. Добавьте его как секрет GitHub

Сохраните ваш ключ API как секрет с именем `QWEN_API_KEY` в вашем репозитории:

- Перейдите в **Настройки > Секреты и переменные > Actions** вашего репозитория
- Нажмите **Новый секрет репозитория**
- Имя: `QWEN_API_KEY`, Значение: ваш ключ API

### 3. Обновите ваш .gitignore

Добавьте следующие записи в ваш файл `.gitignore`:

```gitignore

# настройки qwen-code-cli
.qwen/

# учетные данные GitHub App
gha-creds-*.json
```

### 4. Выберите рабочий процесс

У вас есть два варианта настройки рабочего процесса:

**Вариант A: Использовать команду setup (Рекомендуется)**

1. Запустите Qwen Code CLI в вашем терминале:

   ```shell
   qwen
   ```

2. В Qwen Code CLI в вашем терминале введите:

   ```
   /setup-github
   ```

**Вариант B: Вручную скопировать рабочие процессы**

1. Скопируйте предварительно созданные рабочие процессы из директории [`examples/workflows`](./examples/workflows) в директорию `.github/workflows` вашего репозитория. Примечание: рабочий процесс `qwen-dispatch.yml` также должен быть скопирован, он запускает выполнение других рабочих процессов.

### 5. Попробуйте сами

**Проверка Pull Request:**

- Откройте pull request в вашем репозитории и дождитесь автоматической проверки
- Оставьте комментарий `@qwencoder /review` в существующем pull request, чтобы вручную запустить проверку

**Триаж задач:**

- Откройте задачу и дождитесь автоматического триажа
- Оставьте комментарий `@qwencoder /triage` в существующих задачах, чтобы вручную запустить триаж

**Общая помощь с помощью ИИ:**

- В любой задаче или pull request упомяните `@qwencoder`, а затем добавьте свой запрос
- Примеры:
  - `@qwencoder explain this code change`
  - `@qwencoder suggest improvements for this function`
  - `@qwencoder help me debug this error`
  - `@qwencoder write unit tests for this component`

## Рабочие процессы

Это действие предоставляет несколько предварительно созданных рабочих процессов для различных случаев использования. Каждый рабочий процесс предназначен для копирования в каталог `.github/workflows` вашего репозитория и последующей настройки при необходимости.

### Qwen Code Dispatch

Этот рабочий процесс выступает в качестве центрального диспетчера для Qwen Code CLI, направляя запросы в
соответствующий рабочий процесс на основе события запуска и команды, указанной
в комментарии. Подробное руководство по настройке рабочего процесса диспетчеризации см.
в
[документации по рабочему процессу Qwen Code Dispatch](./examples/workflows/qwen-dispatch).

### Триаж задач

Это действие можно использовать для автоматического или запланированного триажа задач GitHub.
Подробное руководство по настройке системы триажа задач см.
в
[документации по рабочему процессу триажа задач GitHub](./examples/workflows/issue-triage).

### Проверка пулл-реквестов

Это действие можно использовать для автоматической проверки пулл-реквестов при их
открытии. Подробное руководство по настройке системы проверки пулл-реквестов см.
в [документации по рабочему процессу проверки PR GitHub](./examples/workflows/pr-review).

### Qwen Code CLI Assistant

Этот тип действия можно использовать для вызова универсального разговорного помощника Qwen Code
ИИ в пулл-реквестах и задачах для выполнения широкого спектра
задач. Подробное руководство по настройке рабочего процесса Qwen Code CLI общего назначения
можно найти в [документации по рабочему процессу Qwen Code Assistant](./examples/workflows/qwen-assistant).

## Конфигурация

### Входные параметры

<!-- BEGIN_AUTOGEN_INPUTS -->

- <a name="__input_qwen_api_key"></a><a href="#user-content-__input_qwen_api_key"><code>qwen*api_key</code></a>: *(Необязательно)\_ Ключ API для Qwen API.

- <a name="__input_qwen_cli_version"></a><a href="#user-content-__input_qwen_cli_version"><code>qwen*cli_version</code></a>: *(Необязательно, по умолчанию: `latest`)\_ Версия Qwen Code CLI для установки. Может быть "latest", "preview", "nightly", конкретным номером версии или веткой, тегом или коммитом git. Дополнительную информацию см. в разделе [Релизы Qwen Code CLI](https://github.com/QwenLM/qwen-code-action/blob/main/docs/releases.md).

- <a name="__input_qwen_debug"></a><a href="#user-content-__input_qwen_debug"><code>qwen*debug</code></a>: *(Необязательно)\_ Включить отладочное логирование и потоковую передачу вывода.

- <a name="__input_qwen_model"></a><a href="#user-content-__input_qwen_model"><code>qwen*model</code></a>: *(Необязательно)\_ Модель для использования с Qwen Code.

- <a name="__input_prompt"></a><a href="#user-content-__input_prompt"><code>prompt</code></a>: _(Необязательно, по умолчанию: `You are a helpful assistant.`)_ Строка, передаваемая в аргумент [`--prompt`](https://github.com/QwenLM/qwen-code-action/blob/main/docs/cli/configuration.md#command-line-arguments) Qwen Code CLI.

- <a name="__input_settings"></a><a href="#user-content-__input_settings"><code>settings</code></a>: _(Необязательно)_ Строка JSON, записываемая в `.qwen/settings.json` для настройки параметров _проекта_ CLI.
  Дополнительные сведения см. в документации по [файлам настроек](https://github.com/QwenLM/qwen-code-action/blob/main/docs/cli/configuration.md#settings-files).

- <a name="__input_use_qwen_code_assist"></a><a href="#user-content-__input_use_qwen_code_assist"><code>use*qwen_code_assist</code></a>: *(Необязательно, по умолчанию: `false`)\_ Использовать ли Code Assist для доступа к модели Qwen Code вместо стандартного ключа API Qwen Code.
  Дополнительную информацию см. в [документации Qwen Code CLI](https://github.com/QwenLM/qwen-code-action/blob/main/docs/cli/authentication.md).

- <a name="__input_use_vertex_ai"></a><a href="#user-content-__input_use_vertex_ai"><code>use*vertex_ai</code></a>: *(Необязательно, по умолчанию: `false`)\_ Использовать ли Vertex AI для доступа к модели Qwen Code вместо стандартного ключа API Qwen Code.
  Дополнительную информацию см. в [документации Qwen Code CLI](https://github.com/QwenLM/qwen-code-action/blob/main/docs/cli/authentication.md).

- <a name="__input_extensions"></a><a href="#user-content-__input_extensions"><code>extensions</code></a>: _(Необязательно)_ Список расширений Qwen Code CLI для установки.

- <a name="__input_upload_artifacts"></a><a href="#user-content-__input_upload_artifacts"><code>upload*artifacts</code></a>: *(Необязательно, по умолчанию: `false`)\_ Загружать ли артефакты в действие GitHub.

- <a name="__input_use_pnpm"></a><a href="#user-content-__input_use_pnpm"><code>use*pnpm</code></a>: *(Необязательно, по умолчанию: `false`)\_ Использовать ли pnpm вместо npm для установки qwen-code-cli

- <a name="__input_workflow_name"></a><a href="#user-content-__input_workflow_name"><code>workflow*name</code></a>: *(Необязательно, по умолчанию: `${{ github.workflow }}`)\_ Имя рабочего процесса GitHub, используется в целях телеметрии.

<!-- END_AUTOGEN_INPUTS -->

### Выходные данные

<!-- BEGIN_AUTOGEN_OUTPUTS -->

- <a name="__output_summary"></a><a href="#user-content-__output_summary"><code>summary</code></a>: Сводный вывод из выполнения Qwen Code CLI.

- <a name="__output_error"></a><a href="#user-content-__output_error"><code>error</code></a>: Вывод ошибки из выполнения Qwen Code CLI, если таковая имеется.

<!-- END_AUTOGEN_OUTPUTS -->

### Переменные репозитория

Мы рекомендуем задать следующие значения в виде переменных репозитория, чтобы их можно было повторно использовать во всех рабочих процессах. В качестве альтернативы вы можете задать их непосредственно в виде входных данных действия в отдельных рабочих процессах или переопределить значения на уровне репозитория.

| Имя                | Описание                                                  | Тип      | Обязательно | Когда требуется           |
| ------------------ | --------------------------------------------------------- | -------- | ----------- | ------------------------- |
| `DEBUG`            | Включает ведение журнала отладки для Qwen Code CLI.       | Переменная | Нет         | Никогда                   |
| `QWEN_CLI_VERSION` | Управляет версией Qwen Code CLI, которая будет установлена.| Переменная | Нет         | Фиксирование версии CLI   |
| `APP_ID`           | Идентификатор GitHub App для пользовательской авторизации.| Переменная | Нет         | При использовании GitHub App|

Чтобы добавить переменную репозитория:

1. Перейдите в раздел **Настройки (Settings) > Секреты и переменные (Secrets and variables) > Действия (Actions) > Новая переменная (New variable)** вашего репозитория.
2. Введите имя переменной и её значение.
3. Сохраните.

Дополнительные сведения о переменных репозитория см. в [документации GitHub по переменным][variables].

[variables]: https://docs.github.com/en/actions/learn-github-actions/variables

### Секреты

Вы можете задать следующие секреты в вашем репозитории:

| Имя               | Описание                                      | Обязательный | Когда требуется                          |
| ----------------- | --------------------------------------------- | ------------ | ---------------------------------------- |
| `QWEN_API_KEY`    | Ваш API-ключ Qwen из DashScope.               | Да           | Требуется для всех процессов, вызывающих Qwen. |
| `APP_PRIVATE_KEY` | Приватный ключ вашего GitHub App (формат PEM). | Нет          | При использовании собственного GitHub App. |

Чтобы добавить секрет:

1. Перейдите в **Настройки репозитория > Secrets and variables > Actions > New repository secret**.
2. Введите имя и значение секрета.
3. Сохраните.

Для получения дополнительной информации обратитесь к
[официальной документации GitHub по созданию и использованию зашифрованных секретов][secrets].

## Аутентификация

Это действие требует аутентификации в GitHub API и, при необходимости, в сервисах Qwen Code.

### Аутентификация через GitHub

Вы можете пройти аутентификацию в GitHub двумя способами:

1. **Стандартный `GITHUB_TOKEN`:** Для более простых случаев использования действие может использовать стандартный `GITHUB_TOKEN`, предоставляемый рабочим процессом.
2. **Пользовательское GitHub-приложение (рекомендуется):** Для наиболее безопасной и гибкой аутентификации мы рекомендуем создать собственное GitHub-приложение.

Подробные инструкции по настройке как Qwen, так и аутентификации через GitHub доступны в [**документации по аутентификации**](./docs/authentication.md).

## Расширения

Интерфейс командной строки Qwen Code можно расширить дополнительными функциями с помощью расширений. Эти расширения устанавливаются из исходного кода из их репозиториев на GitHub.

Подробные инструкции по установке и настройке расширений доступны в [документации по расширениям](./docs/extensions.md).

## Рекомендации

Чтобы обеспечить безопасность, надежность и эффективность автоматизированных рабочих процессов, мы настоятельно рекомендуем следовать нашим лучшим практикам. Эти рекомендации охватывают ключевые области, такие как безопасность репозитория, конфигурация рабочих процессов и мониторинг.

Ключевые рекомендации включают:

- **Обеспечение безопасности вашего репозитория:** реализация защиты веток и тегов, а также ограничение круга утверждающих пул-реквесты.
- **Мониторинг и аудит:** регулярный просмотр журналов действий и включение OpenTelemetry для более глубокого понимания производительности и поведения.

Полное руководство по защите вашего репозитория и рабочих процессов можно найти в нашей [**документации по лучшим практикам**](./docs/best-practices.md).

## Настройка

Создайте файл [QWEN.md] в корне вашего репозитория, чтобы предоставить
контекст и инструкции, специфичные для проекта, для [Qwen Code CLI]. Это полезно для определения
соглашений о кодировании, архитектурных шаблонов или других рекомендаций, которым модель должна
следовать для данного репозитория.

## Участие в разработке

Вклад приветствуется! Ознакомьтесь с [**Руководством по участию**][Qwen Code CLI] для получения дополнительной информации о том, как начать работу.

[secrets]: https://docs.github.com/en/actions/security-guides/using-secrets-in-github-actions
[Qwen Code]: https://github.com/QwenLM/qwen-code
[DashScope]: https://dashscope.console.aliyun.com/apiKey
[Qwen Code CLI]: https://github.com/QwenLM/qwen-code-action/
[variables]: https://docs.github.com/en/actions/how-tos/write-workflows/choose-what-workflows-do/use-variables#creating-configuration-variables-for-a-repository
[GitHub CLI]: https://docs.github.com/en/github-cli/github-cli
[QWEN.md]: https://github.com/QwenLM/qwen-code-action/blob/main/docs/cli/configuration.md#context-files-hierarchical-instructional-context