# Режим одобрения

Qwen Code предлагает три различных режима разрешений, которые позволяют гибко управлять тем, как ИИ взаимодействует с вашим кодом и системой, в зависимости от сложности задачи и уровня риска.

## Сравнение режимов разрешений

| Режим          | Редактирование файлов       | Команды оболочки            | Лучше всего подходит для                                                                              | Уровень риска |
| -------------- | --------------------------- | --------------------------- | ----------------------------------------------------------------------------------------------------- | ------------- |
| **Plan**​      | ❌ Только чтение и анализ   | ❌ Не выполняются           | • Изучение кода <br>• Планирование сложных изменений <br>• Безопасный просмотр кода                   | Самый низкий  |
| **Default**​   | ✅ Требуется ручное одобрение | ✅ Требуется ручное одобрение | • Новые/незнакомые кодовые базы <br>• Критические системы <br>• Совместная работа в команде <br>• Обучение | Низкий        |
| **Auto-Edit**​ | ✅ Автоматическое одобрение   | ❌ Требуется ручное одобрение | • Повседневные задачи разработки <br>• Рефакторинг и улучшения кода <br>• Безопасная автоматизация     | Средний       |
| **YOLO**​      | ✅ Автоматическое одобрение   | ✅ Автоматическое одобрение   | • Доверенные личные проекты <br>• Автоматизированные скрипты/CI/CD <br>• Задачи пакетной обработки    | Самый высокий |

### Краткое справочное руководство

- **Начните с режима Plan**: Отлично подходит для понимания перед внесением изменений
- **Работайте в режиме Default**: Сбалансированный выбор для большинства задач разработки
- **Переключитесь в Auto-Edit**: Когда вы вносите множество безопасных изменений в коде
- **Используйте YOLO умеренно**: Только для доверенной автоматизации в контролируемых средах

> [!tip]
>
> Вы можете быстро переключаться между режимами во время сессии, используя **Shift+Tab**. В строке состояния терминала отображается текущий режим, поэтому вы всегда знаете, какие разрешения имеет Qwen Code.

## 1. Используйте режим Plan для безопасного анализа кода

Режим Plan указывает Qwen Code создать план, анализируя кодовую базу с помощью операций **только для чтения**, что идеально подходит для изучения кодовых баз, планирования сложных изменений или безопасного просмотра кода.

### Когда использовать режим Plan

- **Многоэтапная реализация**: Когда ваша функция требует внесения изменений во многие файлы
- **Исследование кода**: Когда вы хотите тщательно изучить кодовую базу перед внесением каких-либо изменений
- **Интерактивная разработка**: Когда вы хотите итеративно определять направление с помощью Qwen Code

### Как использовать режим планирования

**Включение режима планирования во время сеанса**

Вы можете переключиться в режим планирования во время сеанса, используя **Shift+Tab** для переключения между режимами разрешений.

Если вы находитесь в обычном режиме, **Shift+Tab** сначала переключает в режим `auto-edits`, что обозначено надписью `⏵⏵ accept edits on` в нижней части терминала. Последующее нажатие **Shift+Tab** переключит в режим планирования, обозначенный как `⏸ plan mode`.

**Начало нового сеанса в режиме планирования**

Чтобы начать новый сеанс в режиме планирования, используйте команду `/approval-mode`, затем выберите `plan`

```bash
/approval-mode
```

**Запуск "безголовых" запросов в режиме планирования**

Вы также можете выполнить запрос в режиме планирования напрямую с помощью `-p` или `prompt`:

```bash
qwen --prompt "Что такое машинное обучение?"
```

### Пример: Планирование сложного рефакторинга

```bash
/approval-mode plan
```

```
Мне нужно переработать нашу систему аутентификации для использования OAuth2. Создайте подробный план миграции.
```

Qwen Code анализирует текущую реализацию и создает комплексный план. Уточните с помощью дополнительных вопросов:

```
Как быть с обратной совместимостью?
Как нам следует обрабатывать миграцию базы данных?
```

### Настройка режима Plan как стандартного

```json
// .qwen/settings.json
{
  "permissions": {
    "defaultMode": "plan"
  }
}
```

## 2. Использование стандартного режима для контролируемого взаимодействия

Стандартный режим — это обычный способ работы с Qwen Code. В этом режиме вы сохраняете полный контроль над всеми потенциально опасными операциями — Qwen Code будет запрашивать ваше одобрение перед внесением любых изменений в файлы или выполнением команд оболочки.

### Когда использовать режим по умолчанию

- **Новичок в кодовой базе**: Когда вы изучаете незнакомый проект и хотите действовать особенно осторожно
- **Критические системы**: Когда вы работаете с производственным кодом, инфраструктурой или конфиденциальными данными
- **Обучение и преподавание**: Когда вы хотите понять каждый шаг, который выполняет Qwen Code
- **Совместная работа в команде**: Когда над одной кодовой базой работают несколько человек
- **Сложные операции**: Когда изменения затрагивают несколько файлов или сложную логику

### Как использовать режим по умолчанию

**Включение режима по умолчанию во время сеанса**

Вы можете переключиться в режим по умолчанию во время сеанса, используя **Shift+Tab** для циклического переключения между режимами разрешений. Если вы находитесь в любом другом режиме, нажатие **Shift+Tab** в конечном итоге вернет вас к режиму по умолчанию, что indicated отсутствием любого индикатора режима в нижней части терминала.

**Начало нового сеанса в режиме по умолчанию**

Режим по умолчанию является начальным режимом при запуске Qwen Code. Если вы изменили режимы и хотите вернуться к режиму по умолчанию, используйте:

```
/approval-mode default
```

**Запуск "безголовых" запросов в режиме по умолчанию**

При выполнении безголовых команд поведением по умолчанию является режим по умолчанию. Вы можете явно указать его с помощью:

```
qwen --prompt "Analyze this code for potential bugs"
```

### Пример: Безопасная реализация функции

```
/approval-mode default
```

```
Мне нужно добавить пользовательские аватары в наше приложение. Изображения должны храниться в бакете S3, а URL сохраняться в базе данных.
```

Qwen Code проанализирует вашу кодовую базу и предложит план. Затем он запросит подтверждение перед:

1. Созданием новых файлов (контроллеры, модели, миграции)
2. Изменением существующих файлов (добавление новых столбцов, обновление API)
3. Выполнением любых команд оболочки (миграции базы данных, установка зависимостей)

Вы можете просмотреть каждое предложенное изменение и одобрить или отклонить его индивидуально.

### Установка режима по умолчанию как default

```bash
// .qwen/settings.json
{
  "permissions": {
    "defaultMode": "default"
  }
}
```

## 3. Режим автоматического редактирования

Режим автоматического редактирования указывает Qwen Code автоматически одобрять изменения файлов, но требовать ручного подтверждения для выполнения команд оболочки. Это идеальный вариант для ускорения процесса разработки с сохранением безопасности системы.

### Когда использовать режим автоматического принятия изменений

- **Повседневная разработка**: идеально подходит для большинства задач программирования
- **Безопасная автоматизация**: позволяет ИИ изменять код, при этом предотвращая случайное выполнение опасных команд
- **Командная работа**: используйте в совместных проектах, чтобы избежать непреднамеренного влияния на других участников

### Как переключиться в этот режим

```

# Переключение с помощью команды
/approval-mode auto-edit

# Или используйте сочетание клавиш
Shift+Tab  # Переключение с других режимов
```

### Пример рабочего процесса

1. Вы просите Qwen Code рефакторить функцию
2. ИИ анализирует код и предлагает изменения
3. **Автоматически** применяет все изменения файлов без подтверждения
4. Если необходимо запустить тесты, он **запросит разрешение** на выполнение `npm test`

## 4. Режим YOLO — полная автоматизация

Режим YOLO предоставляет Qwen Code максимальные права, автоматически одобряя все вызовы инструментов, включая редактирование файлов и команды оболочки.

### Когда использовать режим YOLO

- **Автоматизированные скрипты**: Выполнение заранее определённых автоматических задач
- **Конвейеры CI/CD**: Автоматическое выполнение в контролируемых средах
- **Личные проекты**: Быстрая итерация в полностью доверенных средах
- **Пакетная обработка**: Задачи, требующие цепочки команд из нескольких шагов

> [!warning]
>
> **Используйте режим YOLO с осторожностью**: ИИ может выполнять любые команды с вашими разрешениями терминала. Убедитесь, что:
>
> 1. Вы доверяете текущей кодовой базе
> 2. Вы понимаете все действия, которые ИИ собирается выполнить
> 3. Важные файлы сохранены или зафиксированы в системе контроля версий

### Как включить режим YOLO

```

# Временное включение (только для текущего сеанса)
/approval-mode yolo

# Установка по умолчанию для проекта
/approval-mode yolo --project

# Установка глобально по умолчанию для пользователя
/approval-mode yolo --user
```

### Пример конфигурации

```bash
// .qwen/settings.json
{
  "permissions": {
"defaultMode": "yolo",
"confirmShellCommands": false,
"confirmFileEdits": false
  }
}
```

### Пример автоматизированного рабочего процесса

```bash

# Полностью автоматизированная задача рефакторинга
qwen --prompt "Запустить набор тестов, исправить все падающие тесты, затем закоммитить изменения"

# Без участия человека, ИИ будет:

# 1. Запускать команды тестирования (автоматическое подтверждение)

# 2. Исправлять упавшие тест-кейсы (автоматическое редактирование файлов)

# 3. Выполнять git commit (автоматическое подтверждение)
```

## Переключение режимов и конфигурация

### Переключение с помощью клавиатурных сокращений

Во время сессии Qwen Code используйте **Shift+Tab**​ для быстрого переключения между тремя режимами:

```
Режим по умолчанию → Режим авто-редактирования → Режим YOLO → Режим планирования → Режим по умолчанию
```

### Постоянная конфигурация

```
// На уровне проекта: ./.qwen/settings.json
// На уровне пользователя: ~/.qwen/settings.json
{
  "permissions": {
"defaultMode": "auto-edit",  // или "plan" или "yolo"
"confirmShellCommands": true,
"confirmFileEdits": true
  }
}
```

### Рекомендации по использованию режимов

1. **Новичок в кодовой базе**: Начните с **Режима планирования** для безопасного изучения
2. **Повседневные задачи разработки**: Используйте **Автопринятие правок** (режим по умолчанию) — эффективно и безопасно
3. **Автоматизированные скрипты**: Используйте **Режим YOLO** в контролируемых средах для полной автоматизации
4. **Сложный рефакторинг**: Сначала используйте **Режим планирования** для детального планирования, затем переключитесь на подходящий режим для выполнения