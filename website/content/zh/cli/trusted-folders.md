# 可信文件夹

可信文件夹功能是一项安全设置，让你可以控制哪些项目能够使用 Qwen Code 的全部功能。该功能通过在 CLI 从项目文件夹加载任何项目特定配置之前，要求你批准该文件夹，从而防止潜在的恶意代码运行。

## 启用该功能

可信文件夹功能**默认是禁用的**。要使用该功能，你必须先在设置中启用它。

在你的用户 `settings.json` 文件中添加以下内容：

```json
{
  "security": {
    "folderTrust": {
      "enabled": true
    }
  }
}
```

## 工作原理：信任对话框

启用该功能后，当你第一次从某个文件夹运行 Qwen Code 时，系统会自动弹出一个对话框，提示你进行选择：

- **信任文件夹**：授予当前文件夹完全信任权限（例如 `my-project`）。
- **信任父文件夹**：授予父目录信任权限（例如 `safe-projects`），这将自动信任其所有子目录。如果你将所有安全项目都放在同一个位置，这个选项会很有用。
- **不信任**：将该文件夹标记为不受信任。CLI 将在受限的“安全模式”下运行。

你的选择会被保存在一个中心文件中（`~/.qwen/trustedFolders.json`），因此每个文件夹只需设置一次信任状态。

## 为什么信任很重要：不受信任工作区的影响

当一个文件夹被标记为**不受信任**时，Qwen Code 会以受限的“安全模式”运行，以保护你。在此模式下，以下功能将被禁用：

1.  **工作区设置将被忽略**：CLI 将**不会**加载项目中的 `.qwen/settings.json` 文件。这可以防止加载自定义工具和其他潜在危险的配置。

2.  **环境变量将被忽略**：CLI 将**不会**加载项目中的任何 `.env` 文件。

3.  **扩展管理受限**：你**无法安装、更新或卸载**扩展。

4.  **工具自动接受功能被禁用**：即使你在全局启用了自动接受，系统也会在每次运行工具前提示你确认。

5.  **自动内存加载被禁用**：CLI 不会根据本地设置中指定的目录自动将文件加载到上下文中。

授予文件夹信任权限后，即可解锁 Qwen Code 在该工作区中的全部功能。

## 管理你的信任设置

如果你需要更改某个决定或查看所有设置，你可以选择以下几种方式：

- **更改当前文件夹的信任状态**：在 CLI 中运行 `/permissions` 命令。这将弹出相同的交互式对话框，允许你为当前文件夹更改信任级别。

- **查看所有信任规则**：要查看你所有已信任和未信任的文件夹规则完整列表，可以检查你主目录下的 `~/.qwen/trustedFolders.json` 文件内容。

## 信任检查流程（高级）

对于高级用户，了解信任判定的确切操作顺序会很有帮助：

1.  **IDE 信任信号**：如果你正在使用 [IDE 集成](./ide-integration.md)，CLI 首先会询问 IDE 当前工作区是否受信任。IDE 的响应具有最高优先级。

2.  **本地信任文件**：如果 IDE 未连接，CLI 会检查中心化的 `~/.qwen/trustedFolders.json` 文件。